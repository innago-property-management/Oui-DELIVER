on:
  push:
    branches-ignore:
      - main
  workflow_dispatch:

jobs:
  create-array:
    runs-on: ubuntu-latest
    outputs:
      file_list: ${{ steps.list_files.outputs.output_files }}
    steps:
      - name: Checkout code
        uses: actions/checkout@11bd71901bbe5b1630ceea73d27597364c9af683 # v4
      - name: List Files and Create Array
        id: list_files
        run: |
          FILES=$(ls -1 | tr '\n' ' ')
          echo "${FILES}"
          echo "output_files=${FILES}" >> "$GITHUB_OUTPUT"
  
  use-array:
    runs-on: ubuntu-latest
    needs: create-array
    strategy:
      matrix:
        files: ${{ needs.create-array.outputs.file_list }}
    steps:
      - name: Use Array Output
        with:
          file: ${{ matrix.files }}
        shell: bash
        run: |
          echo "${ file }"